<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DICOM 분석기</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <link rel="stylesheet" href="./css/custom.css" />
    <style>
      /* 테이블 스타일 개선 */
      #tagTable {
        table-layout: fixed;
        width: 100%;
      }

      #tagTable th:nth-child(1) {
        width: 120px;
      } /* Tag ID */
      #tagTable th:nth-child(2) {
        width: 250px;
      } /* Description */
      #tagTable th:nth-child(3) {
        width: 60px;
      } /* VR */
      #tagTable th:nth-child(4) {
        width: 60px;
      } /* VM */
      #tagTable th:nth-child(5) {
        width: 80px;
      } /* Length */
      #tagTable th:nth-child(6) {
        width: auto;
      } /* Value - 나머지 공간 */

      /* Value 셀 스타일 */
      .value-cell {
        min-width: 0; /* flex-shrink 허용 */
      }

      .value-container {
        width: 100%;
        min-width: 0; /* flex-shrink 허용 */
      }

      .value-text {
        white-space: nowrap;
        overflow: hidden;
        min-width: 0; /* flex-shrink 허용 */
      }

      /* 토스트 메시지 스타일 */
      .toast-message {
        min-width: 250px;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      }

      /* 이미지 뷰어 스타일 */
      #imageViewer {
        background-color: #f8f9fa;
        position: relative;
      }

      #dicomImage {
        object-fit: contain;
      }

      /* 로딩 스피너 스타일 */
      .loading-spinner {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
      }

      /* 테이블 반응형 */
      @media (max-width: 768px) {
        #tagTable th:nth-child(2) {
          width: 200px;
        }
        #tagTable th:nth-child(3),
        #tagTable th:nth-child(4),
        #tagTable th:nth-child(5) {
          width: 50px;
        }
      }
    </style>
  </head>
  <body class="bg-gray-100">
    <div
      id="menuBar"
      class="flex justify-between items-center p-4 bg-white shadow fixed top-0 left-0 right-0 z-10"
    >
      <div class="flex items-center space-x-2">
        <input type="file" id="dicomFile" accept=".dcm,.dicom" class="hidden" />
        <button
          id="btnSelect"
          class="bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600 transition-colors"
        >
          DICOM 파일 선택
        </button>
        <button
          id="btnUpload"
          class="bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600 transition-colors opacity-50 cursor-not-allowed"
          disabled
        >
          업로드
        </button>
        <span
          id="selectedFileName"
          class="text-gray-700 ml-4 max-w-md truncate"
        ></span>
        <div
          id="loader"
          class="hidden ml-2 border-t-2 border-blue-500 rounded-full w-6 h-6 animate-spin"
        ></div>
      </div>
      <div class="flex space-x-2">
        <button
          id="btnChart"
          class="bg-green-500 text-white py-2 px-4 rounded hover:bg-green-600 transition-colors opacity-50 cursor-not-allowed"
          disabled
        >
          구조 보기
        </button>
        <button
          id="btnTable"
          class="bg-green-500 text-white py-2 px-4 rounded hover:bg-green-600 transition-colors opacity-50 cursor-not-allowed"
          disabled
        >
          DICOM 태그
        </button>
        <button
          id="btnViewer"
          class="bg-green-500 text-white py-2 px-4 rounded hover:bg-green-600 transition-colors opacity-50 cursor-not-allowed"
          disabled
        >
          영상 보기
        </button>
      </div>
    </div>

    <div
      id="dicomTree"
      class="absolute top-24 left-0 w-full h-[calc(100vh-6rem)] overflow-auto bg-white"
    ></div>

    <div
      id="tagTableContainer"
      class="hidden absolute top-24 left-0 w-full h-[calc(100vh-6rem)] overflow-auto p-4 bg-white"
    >
      <h2 class="text-xl font-bold mb-4">DICOM Tag 정보</h2>
      <div class="overflow-x-auto">
        <table
          id="tagTable"
          class="w-full bg-white border-collapse border border-gray-300 text-sm"
        >
          <thead>
            <tr class="bg-gray-200">
              <th class="border px-2 py-2 text-left">Tag ID</th>
              <th class="border px-2 py-2 text-left">Description</th>
              <th class="border px-2 py-2 text-left">VR</th>
              <th class="border px-2 py-2 text-left">VM</th>
              <th class="border px-2 py-2 text-left">Length</th>
              <th class="border px-2 py-2 text-left">Value</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>

    <div
      id="imageViewer"
      class="hidden absolute top-24 left-0 w-full h-[calc(100vh-6rem)] overflow-auto flex justify-center items-center p-4 relative"
    >
      <img id="dicomImage" class="max-w-full max-h-full" />
    </div>

    <script type="module" src="./js/main.js"></script>
  </body>
</html>
